class CurrencyConverter{constructor(){this.lang="USD",this.pageLang=$("html")[0].lang,this.rates={},this.containerLoaded=!1}loadLang(e,n){let t="";switch(e){case"en":default:t='<p class="langInfo"><strong>Your gift will be charged in U.S. dollars (USD).</strong> To see the '+this.currencyLang("en",n)+' equivalent choose an amount in USD below. Both amounts will be displayed. FX rates provided by Fixer.io.</p><hr class="currencyDivider"><h3 id="pseudoRates"></h3>';break;case"es":t='<p class="langInfo"><strong>Todos los donativos se convierten a d\xf3lares estadounidenses (USD).</strong> Usa esta calculadora para determinar el monto de tu donativo en '+this.currencyLang("es",n)+' seg\xfan el tipo de cambio actual provisto por Fixer.io.</p><hr class="currencyDivider"><h3 id="pseudoRates"></h3>'}return t}currencyLang(e,n){let t={};switch(n){case"JOD":t={es:"dinares Jordano (JOD)",en:"Jordanian Dinar (JOD)"};break;case"SAR":t={es:"riyales Saud\xedes (SAR)",en:"Saudi Riyal (SAR)"};break;default:t={es:"("+n+")",en:"("+n+")"}}return t[e]}loadConversionContainer(){if(this.containerLoaded)return!1;$.ajax({type:"get",url:"https://resources.peta.org/engaging-networks/services/currency-conversion-backend/fixer-io.php",dataType:"JSON",success:e=>{this.appendConverter(e)},error(e){console.error(e.responseText)}})}conversionRate(e,n,t,r){let o="$";"EUR"==r&&(o="â‚¬");let a=this.lang+"&nbsp;$"+this.numberFormatter(n)+" <wbr>= "+r+"&nbsp;"+o+this.numberFormatter(t);$("h3#pseudoRates").html(a)}numberFormatter(e){let n=parseFloat(e).toFixed(2),t=String(n).split("."),r=t[0].split("").reverse(),o=[];return jQuery.each(r,function(e,n){o.push(n),(e+1)%3==0&&e<r.length-1&&o.push(",")}),o=o.reverse().join("")+"."+t[1]}appendConverter(e){if(this.containerLoaded)return;let n=[e];if($(".en__field--donationAmt").before('<style>p.currencySelectLabel{display:inline;}p.langInfo{font-size:.74rem;}.en__field--pseudo-currencyConverter{width: 100%;}.en__field--pseudo-currencyText{width: 120px; display: inline-block !important;     margin-left: 0.1rem;}#en__field_pseudo_currencyConverter{max-width: 110px !important;min-width: 80px !important;background-position: calc(100% + 1rem); background-origin: content-box; padding-right: 1.5rem;padding-left: 1rem;margin-left: .5rem;margin-bottom: 0;}select#en__field_pseudo_currencyConverter:focus{box-shadow: 0 0 0;}#pseudo_Info{padding: 1rem;display: block;border: 1px solid rgb(204, 204, 204);border-radius: 5px;margin-top: .25rem;} hr.currencyDivider{margin: 0 0 1rem 0;}</style><div class="en__field en__field--select en__field--0000 en__field--pseudo-currencyConverter"><div class="en__field__element en__field__element--select en__field--pseudo-currencyText"><select id="en__field_pseudo_currencyConverter" class="en__field__input en__field__input--select" name="currencyConverter"></select></div><div id="pseudo_Info" style="display:none;"></div></div>'),!1==n[0].success||null==n)return $(".en__field--pseudo-currencyConverter").css("display","none"),!1==n[0].success&&console.error(n[0].error.info+" https://fixer.io/"),this.containerLoaded=!1,!1;this.rates={USD:n[0].rates.USD,JOD:n[0].rates.JOD,SAR:n[0].rates.SAR},jQuery.each(this.rates,(e,n)=>{e==this.lang?"es"==this.pageLang?($("div.en__field--pseudo-currencyText").before('<p class="currencySelectLabel">Moneda de Preferencia</p>'),$("select#en__field_pseudo_currencyConverter").append('<option value="'+e+'">'+e+"</option>")):($("div.en__field--pseudo-currencyText").before('<p class="currencySelectLabel">Compare Currency</p>'),$("select#en__field_pseudo_currencyConverter").append('<option value="'+e+'">'+e+"</option>")):$("select#en__field_pseudo_currencyConverter").append('<option value="'+e+'">'+e+"</option>")}),$(document).on("change","select#en__field_pseudo_currencyConverter",()=>{console.log("Currency Converter Changed");let e=$("select#en__field_pseudo_currencyConverter option:selected").val();e!=this.lang?$("div#pseudo_Info").css("display","block"):$("div#pseudo_Info").css("display","none");let n=this.rates[e],t=this.rates[this.lang],r=$('input[name="transaction.donationAmt"]:checked').val();$("#pseudo_Info").html(this.loadLang(this.pageLang,e));let o=r*n/t;r||(o=(r=$('input[name="transaction.donationAmt.other"]').val()?$('input[name="transaction.donationAmt.other"]').val():0)*n/t),this.conversionRate(t,r,o,e)}),$(document).on("change",'input[name="transaction.recurrpay"]',()=>{console.log("Recurring Payment Changed");let e=this.rates[$("select#en__field_pseudo_currencyConverter option:selected").val()],n=this.rates[this.lang],t=$('input[name="transaction.donationAmt"]:checked').val(),r=t*e/n;t||($('input[name="transaction.donationAmt.other"]').val()?r=(t=$('input[name="transaction.donationAmt.other"]').val())*e/n:(t=0,r=0)),this.conversionRate(n,t,r,$("select#en__field_pseudo_currencyConverter option:selected").val())}),$("select#en__field_pseudo_currencyConverter option:selected").each(()=>{let e=$("select#en__field_pseudo_currencyConverter option:selected").val(),n=this.rates[e],t=this.rates[this.lang],r=$('input[name="transaction.donationAmt"]:checked').val();$("div#pseudo_Info").html(this.loadLang(this.pageLang,e));let o=r*n/t;r||(o=(r=$('input[name="transaction.donationAmt.other"]').val()?$('input[name="transaction.donationAmt.other"]').val():0)*n/t),this.conversionRate(t,r,o,e)}),$(document).on("click",'input[name="transaction.donationAmt"]',()=>{console.log("Donation Amount Clicked");let e=$('input[name="transaction.donationAmt"]:checked').val(),n=$("select#en__field_pseudo_currencyConverter option:selected").val(),t=this.rates[n]||1,r=this.rates[this.lang];e?this.conversionRate(r,e,e*t/r,n):this.conversionRate(r,0,0,n)}),$('input[name="transaction.donationAmt.other"]').keyup(()=>{let e=$("select#en__field_pseudo_currencyConverter option:selected").val(),n=$('input[name="transaction.donationAmt.other"]').val(),t=this.rates[e]||1,r=this.rates[this.lang];n?$("h3#pseudoRates").html(this.conversionRate(r,n,n*t/r,e)):this.conversionRate(r,0,0,e)}),this.containerLoaded=!0}}const currencyConverter=new CurrencyConverter;currencyConverter.loadConversionContainer();